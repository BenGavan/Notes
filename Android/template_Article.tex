\documentclass[]{article}

% imports
\usepackage{listings}
\usepackage{color}
\definecolor{lightgray}{rgb}{0.95, 0.95, 0.95}
\definecolor{darkgray}{rgb}{.4,.4,.4}
\definecolor{purple}{rgb}{0.65, 0.12, 0.82}

%%% lstlisting
\lstdefinelanguage{JavaScript}{
	keywords={typeof, new, true, false, catch, function, return, null, try, catch, switch, var, if, in, while, do, else, case, default, break, class, static, public, private, protected, void, int, boolean, final, abstract, for, super, this, extends, implements},
	keywordstyle=\color{blue}\bfseries,
	ndkeywords={class, export, boolean, throw, implements, import, this, @Override, @NonNull},
	ndkeywordstyle=\color{darkgray}\bfseries,
	identifierstyle=\color{black},
	sensitive=false,
	comment=[l]{//},
	morecomment=[s]{/*}{*/},
	commentstyle=\color{purple}\ttfamily,
	stringstyle=\color{red}\ttfamily,
	morestring=[b]',
	morestring=[b]"
}

\lstset{
	language=JavaScript,
	backgroundcolor=\color{lightgray},
	extendedchars=true,
	basicstyle=\footnotesize\ttfamily,
	showstringspaces=false,
	showspaces=false,
	numbers=left,
	numberstyle=\footnotesize,
	numbersep=9pt,
	tabsize=2,
	breaklines=true,
	showtabs=false,
	captionpos=b
}
%%%

% New Commands
\renewcommand{\it}[1]{\textit{#1}}

%opening
\title{Android}
\author{Ben Gavan}

\begin{document}

\maketitle
\tableofcontents

%%%%%%%%%%%%%%%%%%%%% Fragments %%%%%%%%%%%%%%%%%%%%%%
\section{Fragments}
\subsubsection{isAdded()}
Checks whether the fragment has been attached to an activity, therefore \textit{getActivity()} will not be \textit{null}.

%%%%%%%%%%%%%%%%%%%%% Dialogs %%%%%%%%%%%%%%%%%%%%%%
\section{Dialogs}
\subsection{Creating a Dialog View}
A dialog is a type of fragment.
\subsubsection{XML}
To create the Dialog View, it is just like creating any other view.
\\
Create a normal layout xml file and create the layout that is required for the dialog.
\paragraph{Example: DatePicker}:
\begin{lstlisting}
<?xml version="1.0" encoding="utf-8"?>
<DatePicker xmlns:android="http://schemas.android.com/apk/res/android"
	android:id="@+id/dialog_date_picker"
	android:layout_width="wrap_content"
	android:layout_height="wrap_content"
	android:calendarViewShown="false">
</DatePicker>
\end{lstlisting}

\subsubsection{The Class}
A Dialog Fragment extends the class $DialogFragment$
\begin{lstlisting}
public class DatePickerFragment extends DialogFragment {
	...
}
\end{lstlisting}

\paragraph{Example: DatePicker}:
\begin{lstlisting}

import android.app.Activity;
import android.app.Dialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.os.Bundle;
import android.support.annotation.NonNull;
import android.support.v4.app.DialogFragment;
import android.support.v7.app.AlertDialog;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.DatePicker;

import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;

/**
* Created by ben on 26/10/2017.
*/

public class DatePickerFragment extends DialogFragment {

	public static final String EXTRA_DATE = "com.bgsoftwarestudios.criminalintent.date";

	private static final String ARG_DATE = "date";

	private DatePicker mDatePicker;

	public static DatePickerFragment newInstance(Date date) {
		Bundle args = new Bundle();
		args.putSerializable(ARG_DATE, date);

		DatePickerFragment fragment = new DatePickerFragment();
		fragment.setArguments(args);
		return fragment;
	}

	@NonNull
	@Override
	public Dialog onCreateDialog(Bundle savedInstanceState) {
		Date date = (Date) getArguments().getSerializable(ARG_DATE);

		Calendar calendar = Calendar.getInstance();
		calendar.setTime(date);
		int year = calendar.get(Calendar.YEAR);
		int month = calendar.get(Calendar.MONTH);
		int day = calendar.get(Calendar.DAY_OF_MONTH);
		
		View view = LayoutInflater.from(getActivity()).inflate(R.layout.dialog_date, null);

		mDatePicker = (DatePicker) view.findViewById(R.id.dialog_date_picker);
		mDatePicker.init(year, month, day, null);

		return new AlertDialog.Builder(getActivity())
						.setView(view)
						.setTitle(R.string.date_picker_title)
						.setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {
							@Override
							public void onClick(DialogInterface dialogInterface, int i) {
								int year = mDatePicker.getYear();
								int month = mDatePicker.getMonth();
								int day = mDatePicker.getDayOfMonth();
								Date date = new GregorianCalendar(year, month, day).getTime();
								sendResult(Activity.RESULT_OK, date);
							}
						})
						.create();
	}

	private void sendResult(int resultCode, Date date) {
			if (getTargetFragment() == null) {
				return;
			}

			Intent intent = new Intent();
			intent.putExtra(EXTRA_DATE, date);

			this.getTargetFragment().onActivityResult(this.getTargetRequestCode(), resultCode, intent);
	}
}

\end{lstlisting}

\subsection{Setting a Target Fragment}
When displaying a dialog view from a fragment, we need to create a relationship between them se we can send data back from the dialog to the fragment.  
\\
We need to pass a reference to the dialog of the fragment, as well as a request code to identify the payload when it is sent back/ so the fragment can 'listen' out for it.
\\
We do this by setting the target fragment on the dialog object:
\begin{lstlisting}
dialog.setTargetFragment(FragmentClass.this, REQUEST_CODE);
\end{lstlisting}

\subsection{Sending data back to the Target Fragment from the Dialog}
We should also check that the target fragment has been set before we do anything
\\
First, we need to get a reference to the target fragment (set by the fragment requesting the display of the dialog via using setTargetFragment on the dialog).
\\
We then call 'onActivityResult' on the target fragment.
\\
So if we want to do something in the fragment i.e. get the data back, we have to override this method in the target fragment.
\\
The data we pass back from the dialog is contained within an intent by putExtra.
\begin{lstlisting}
private void sendResult(int resultCode, Date date) {
	if (getTargetFragment() == null) {
		return;
	}

	Intent intent = new Intent();
	intent.putExtra(EXTRA_DATE, date);

	this.getTargetFragment().onActivityResult(this.getTargetRequestCode(), resultCode, intent);
}
\end{lstlisting}

\subsubsection{Receiving the Data from the intent}
\begin{lstlisting}
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
	if (resultCode != Activity.RESULT_OK) {
		return;
	}

	if (requestCode == REQUEST_DATE) {
		Date date = (Date) data.getSerializableExtra(DatePickerFragment.EXTRA_DATE);
		mCrime.setDate(date);
		mDateButton.setText(mCrime.getDate().toString());
	}
}
\end{lstlisting}
We override the 'onActivityResult' within the target fragment we are sending data back to.
\\
First we check what the result code is (what button the user pressed on the dialog)
\begin{lstlisting}
if (resultCode != Activity.RESULT_OK) {
	return;
}
\end{lstlisting}
We then check what the request code is (which was set by the fragment creating the dialog) so we know that we are responding to the correct result (A fragment can display and react to multiple dialogs). 
\\
After this, we get the data sent back in the form of an extra from the dialog inside an intent by 'getSerializableExtra(...)'.
\\
In this case, we cast this data back to a date so it can be used.
\begin{lstlisting}
if (requestCode == REQUEST_DATE) {
	Date date = (Date) data.getSerializableExtra(DatePickerFragment.EXTRA_DATE);
	mCrime.setDate(date);
	mDateButton.setText(mCrime.getDate().toString());
}
\end{lstlisting}

%%%%%%%%%%%%%%%%%%%%% Toolbar %%%%%%%%%%%%%%%%%%%%%%
\section{The Toolbar}
The Toolbar provides additional mechanisms for navigation, nd also provides design consistency and branding.
\subsubsection{History}
The toolbar component was added to android 5.0 (Lollipop).
\\
Prior to this, the action bar was the recommended component for navigation and actions within an app.
\\
The toolbar and action bar are very similar.
\\
The toolbar builds on top of the action bar .
\\
It has a tweaked UI
\\ 
It's more flexible in the ways you can use it.
\subsubsection{Supported by}
Since the toolbar has been added to the AppCompat library, it is available back to API 9 (Android 2.3)

\subsection{Menus}
The top-right portion of the toolbar is reserved for the toolbar's menu.
\\
The menu consists of action items (sometimes referred to as menu items).
\\
These can perform an action on the current screen or on the app as a whole.

\subsubsection{Defining a menu in XML}
Need to create an XML description of a menu, just like how you have to for layouts, with the resource file inside the res/menu directory.
\\
To create a new menu resource file:
\begin{enumerate}
	\item Right-click on the res directory
	\item Select New $\rightarrow$ Android resource file
	\item Change the Resource type to Menu 
	\item Name the resource (normally 'fragment\_...' - the same naming convention as layout files)
	\item Click OK
\end{enumerate}
In this file, the XML should be:
\begin{lstlisting}
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android"
			xmlns:app="http://schemas.android.com/apk/res-auto">
</menu>
\end{lstlisting}

\subsubsection{Defining an item}
\begin{lstlisting}
<item
	android:id="@+id/new_crime"
	android:icon="@android:drawable/ic_menu_add"
	android:title="@string/new_crime"
	app:showAsAction="ifRoom|withText"/>
\end{lstlisting}
The line 
\begin{lstlisting}
app:showAsAction="ifRoom|withText"
\end{lstlisting}
makes the item be displayed inline/on the toolbar (where the menu icon should be) instead of having the item as a drop down item below the toolbar/menu button.
\\
The showAsAction attribute refers to whether the item will appear in the toolbar itself or in the overflow menu.
\\\\
In this case "ifRoom$|$withText" will make the items icon and text appear in the toolbar if there is room.  
\\If there is room for the icon but not the text, then only the icon will be visible. 
\\If there is no room for either, the item will be relegated to the overflow menu.
\\\\
If there are items in the overflow menu, the three dots will appear and when these are pressed, the overflow menu will be shown below.
\\\\
Multiple menu items can be displayed as Actions on the Toolbar.
\\\\
\paragraph{Possible values for showAsAction}
\begin{itemize}
	\item always 
	\subitem not recommended 
	\subitem Better to use ifRoom and let the OS decide.
	
	\item ifRoom
	\subitem Only displays the item as an Action if there is room
	
	\item never
	\subitem never displayed as an action
	\subitem will always appear in the overflow menu
	\subitem so good for items that are not used very often - its good practice to avoid having to many items on the toolbar to help the screen keep decluttered 
\end{itemize}
The AppCompat library defines its own custom showAsAction attribute and does not look for the native showAsAction attribute.

\subsubsection{Creating the Menu}
Override the function onCreateOptionsMenu(...) inside the Activity/Fragment.
\\
To actually create/inflate the menu:  (Inside the Fragment:)
\begin{lstlisting}
@Override
public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
	super.onCreateOptionsMenu(menu, inflater);
	inflater.inflate(R.menu.fragment_crime_list, menu);
}
\end{lstlisting}
This populates the menu with the items defined in the menu/fragment\_crime\_list.xml file.
\\
The super call is only convention since the superclass, Fragment, does nothing.  (Good to do so the superclass functionality is still applied - can now change the superclass and will still work if we do something in that implementation of this function).
\\\\
We then need to call setHasOptionsMenu(boolean hasMenu) to tell the FragmentManager that this fragment has a menu and should receive a call to onCreateOptionsMenu(...).
\\
Inside the Fragment:
\begin{lstlisting}
@Override
public void onCreate(@Nullable Bundle savedInstanceState) {
	super.onCreate(savedInstanceState);
	setHasOptionsMenu(true);
}
\end{lstlisting}

\subsubsection{Responding to Menu Selection}
Override onOptionsItemSected(...) in the fragment that you have called 'setHasOptionsMenu(true)'.
\\
The MenuItem.getItemId() corresponds to the id of the $<$item$>$ which you set in the xml file for the menu.
\\
This means that we can perform a switch case for each possible id in the menu.
\\
Include a default case to let the super implementation to handle the section of any item that you have not declared.
\\
You should return true you you have handled the item section and that no further processing is necessary.
\begin{lstlisting}
@Override
public boolean onOptionsItemSelected(MenuItem item) {
	switch (item.getItemId()) {
		case R.id.new_crime:
			.... Do some logic here ....
			return true;   // Return true to say that the selection has been handled.
		default:
			return super.onOptionsItemSelected(item);
	}
}
\end{lstlisting}

\subsubsection{Reload/update the menu}
\begin{lstlisting}
getActivity().invalidateOptionsMenu();
\end{lstlisting}
This will cause the menu to be redrawn/reloaded (just like if the device is rotated).
\subsection{Subtitle}
\begin{lstlisting}
private void setSubtitle(String subtitle) {
	AppCompatActivity activity = (AppCompatActivity) getActivity();
	activity.getSupportActionBar().setSubtitle(subtitle);
}
\end{lstlisting}
\begin{itemize}
	\item Get the current activity
	\subitem (We are using AppCompat for backwards compatibility)
	
	\item Get the Toolbar from that activity via getSupportActionBar()
	\subitem Still called/referred to as an Action Bar due to legacy reasons.
	
	\item Set the subtitle of that the toolbar we just received.
\end{itemize}

\subsection{Hierarchical Navigation}
Add parentActivityName to the activity the the manifests so when you press the back arrow on the toolbar, it will go back to the activity you stated.
\begin{lstlisting}
<activity
	android:name=".CrimePagerActivity"
	android:parentActivityName=".CrimeListActivity"/>
\end{lstlisting}

\subsubsection{How Hierarchical Navigation works}
Page 261

%%%%%%%%%%%%%%%%%%%%% AppCompat Library %%%%%%%%%%%%%%%%%%%%%%
\section{AppCompat Library}
\subsection{Requirements}
The AppCompat requires that you:
\begin{itemize}
	\item add the AppCompat dependency
	\item use one of the AppCompat themes 
	\item ensure that all activities are a subclass of AppCompatActivity
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%% SQLite Database %%%%%%%%%%%%%%%%%%%%%%%%%%
\section{SQLite Database}
\subsection{Defining a Schema}
\begin{lstlisting}
public class CrimeDbSchema {

	public static final class CrimeTable {
		public static final String NAME = "crimes";

		public static final class Cols {
			public static final String UUID = "uuid";
			public static final String TITLE = "title";
			public static final String DATA = "date";
			public static final String SOLVED = "solved";
		}
	}
}
\end{lstlisting}

\subsection{Building the Initial Database}
Always need to follow a few basic steps:
\begin{itemize}
	\item Check to see whether the database already exists.
	\item If it does not, create it and create the tables and initial data it needs.
	\item If id does, open it and see what version of the schema it has.
	\item If it is an old version, upgrade it to a newer version.
\end{itemize}
SQLiteOpenHelper can be used to handle all of this.

\subsection{Opening an SQLiteDatabase}
By extending SQLiteOpenHelper, we give control over to it to do the heavy lifting in opening the database.
\begin{lstlisting}
public class CrimeBaseHelper extends SQLiteOpenHelper {

	private static final int VERSION = 1;
	private static final String DATABASE_NAME = "crimeBase.db";

	public CrimeBaseHelper(@Nullable Context context) {
		super(context, DATABASE_NAME, null, VERSION);
	}

	@Override
	public void onCreate(SQLiteDatabase sqLiteDatabase) {

	}

	@Override
	public void onUpgrade(SQLiteDatabase sqLiteDatabase, int i, int i1) {

	}
}
\end{lstlisting}
To access the database we can then call getWritableDatabase()
\begin{lstlisting}
private CrimeLab(Context context) {
	this.mContext = context.getApplicationContext();
	this.mDatabase = new CrimeBaseHelper(mContext).getWritableDatabase();
}
\end{lstlisting}
When we do this, SQLiteOpenHelper will:
\begin{itemize}
	\item open up /data/data/com....../databases/thedatabasebeingopened.db
	\subitem it will create a new database file if it does not already exist.
	
	\item If it is the first time the database has been created, call onCreate(...), then save out the latest version number.
	
	\item If it is not the first time, check the version number.
	\subitem If the version number in CrimeBaseHelper is higher, call onUpgrade(....) 
\end{itemize}

\subsection{Writing to the Database}
\subsubsection{ContentValues}
Writes and updates are done with ContentVales - a key-value store class, like Java's HashMap or Bundles.
\\
Example of a helper function to create the instance of ContentValues for a row:
\begin{lstlisting}
private static ContentValues getContentValues(@NonNull Crime crime) {
	ContentValues values = new ContentValues();
	values.put(CrimeTable.Cols.UUID, crime.getId().toString());
	values.put(CrimeTable.Cols.TITLE, crime.getTitle());
	values.put(CrimeTable.Cols.DATE, crime.getDate().getTime());
	values.put(CrimeTable.Cols.SOLVED, crime.isSolved() ? 1 : 0);

	return values;
}
\end{lstlisting}

\subsubsection{Inserting rows}
Can insert a new row to the database by using the content values object, and using the insert(...,...,...) method on the SQLite database object.

\begin{lstlisting}
public void addCrime(Crime crime) {
	ContentValues values = getContentValues(crime);
	mDatabase.insert(CrimeTable.NAME, null, values);
}
\end{lstlisting}

\subsubsection{Updating Rows}

\begin{lstlisting}
public void updateCrime(Crime crime) {
	String uuidString = crime.getId().toString();
	ContentValues values = getContentValues(crime);
	mDatabase.update(CrimeTable.NAME, values,
		CrimeTable.Cols.UUID + " = ?",
		new String[] { uuidString });
}
\end{lstlisting}
To update a row, the same content values object is used from inserting; however, the update(...,...,...,...) method is called in the database object.
\\
The third parameter is the where clause string which specifies what rows are updated.  In this case, the UUID is used to identify the row.
\\
To do this, the '?' syntax is used which tells the database to treat whatever string is in the following parameter as a pure string - not as SQL code.  This prevents an SQL injection attack.

\subsection{Reading from the Database}
 Reading from the database is done by using the query(...) function. 
 \\
 This returns a 'Cursor' object.
 \\
 A cursor stores the retrieved data in key value pairs.
 \subsubsection{Retrieving a Cursor }
 \begin{lstlisting}
public Cursor queryCrimes(String whereClause, String[] whereArgs) {
	Cursor cursor  = mDatabase.query(
		CrimeTable.NAME,
		null,  // selects all columns
		whereClause,
		whereArgs,
		null, // groupBy
		null,  // having
		null  // orderBy
	);
	return cursor;
}
 \end{lstlisting}
 \subsubsection{Using a Cursor}
 To actually retrieve the returned data/values, the get[Type]([Int]) function is used, where the Int is the key with the value of the column index, and the Type is the type of value which is stored.
 \\
 To get the column index from the column name/title, the getColumnIndex([String]) can be used.
 \begin{lstlisting}
String title = getString(getColumnIndex(CrimeTable.Cols.TITLE));
long date = getLong(getColumnIndex(CrimeTable.Cols.DATE));
int isSolved = getInt(getColumnIndex(CrimeTable.Cols.SOLVED));
 \end{lstlisting} 
 It is cleaning, however, to use a custom wrapper of a cursor to encapsulate the cursor and retrieving of data withing one object.
 \\
 Therefore create a class which extends Cursor
 \begin{lstlisting}
public class CrimeCursorWrapper extends CursorWrapper {

	public CrimeCursorWrapper(Cursor cursor) {
		super(cursor);
	}

	public Crime getCrime() {
		String uuidString = this.getString(this.getColumnIndex(CrimeTable.Cols.UUID));
		String title = getString(getColumnIndex(CrimeTable.Cols.TITLE));
		long date = getLong(getColumnIndex(CrimeTable.Cols.DATE));
		int isSolved = getInt(getColumnIndex(CrimeTable.Cols.SOLVED));

		Crime crime = new Crime(UUID.fromString(uuidString));
		crime.setTitle(title);
		crime.setDate(new Date(date));
		crime.setSolved(isSolved != 0);

		return crime;
	}
}
 \end{lstlisting}
From this point, convert the retrieved data into model objects.
\\
To move the cursor along from one part of the query to the next, use the Cursor.moveToFirst() to move to the beginning of the query and Cursor.moveToNext() to move to the next position.
\\
To check is the cursor is still inside the data set, using Cursor.isAfterLast()
\\
Hence the name, cursor.
\begin{lstlisting}
public List<Crime> getCrimes() {
	List<Crime> crimes = new ArrayList<>();
	CrimeCursorWrapper cursorWrapper = queryCrimes(null, null);

	try {
		cursorWrapper.moveToFirst();
		while (!cursorWrapper.isAfterLast()) {
			crimes.add(cursorWrapper.getCrime());
			cursorWrapper.moveToNext();
		}
	} finally {
		cursorWrapper.close();
	}
	
	return crimes;
}
\end{lstlisting}
Remember to close the cursor.
\\
If you don't the app will run out of open file handlers and the app will crash.
\\
Example of retrieving specific row:
\begin{lstlisting}
public Crime getCrime(UUID id) {
	CrimeCursorWrapper cursor = queryCrimes(
		CrimeTable.Cols.UUID + "",
		new String[] { id.toString() }
	);

	try {
		if (cursor.getCount() == 0) {
		return null;
	}

	cursor.moveToFirst();
	return cursor.getCrime();
	} finally {
		cursor.close();
	}
}
\end{lstlisting}

\subsection{Deleting Rows}
\begin{lstlisting}
mDatabase.delete(CrimeTable.NAME, 
					CrimeTable.Cols.UUID + " = ?",
					new String[] { crime.getId().toString() });
\end{lstlisting}

%%%%%%%%%%%%%%%%%%% Implicit Intents  %%%%%%%%%%%%%%%%%%%
\section{Implicit Intents}
Implicit intents are used to start activities in another app.
\\
In an implicit intent, you describe the job you require to be completed, and the OS will open an appropriate activity.
\\
Compared to Explicit intents where you specify the class of the activity to start.
\subsection{The Parts of an Implicit Intent}
\begin{itemize}
	\item action
	\subitem Typically constants from the Intent class.
	\subitem 
	
	\item location of any data
	\item type of data that the action is for
	\item optional categories
\end{itemize}
They can also include extras.  However, there are not used by the OS to find the most appropait 

\subsection{Advertising an Activity to Accept Implicit Intents}
For example, to advertise an activity's capability to handle an implicit intent to open a web page, the following has the be declared within the AppManifest file.
\begin{lstlisting}
<activity android:name=".BrowserActivity">
	<intent-filter>
		<action android:name="android.intent.action.VIEW"/>
		<category android:name="android.intent.category.DEFAULT"/>
		<data android:scheme="http" android:host="www.somewhere.com"/>
	</intent-filter>
</activity>
\end{lstlisting}

\subsection{Sending Text}
\subsubsection{With option of send}
\begin{lstlisting}
Intent intent = new Intent(Intent.ACTION_SEND);
intent.setType("text/plain");
intent.putExtra(Intent.EXTRA_TEXT, getCrimeReport());
intent.putExtra(Intent.EXTRA_SUBJECT, getString(R.string.crime_report_subject));
intent = Intent.createChooser(intent, getString(R.string.send_report));
startActivity(intent);
\end{lstlisting}

\subsection{Requesting Android for a Contact}
\subsubsection{The Request of Data}
The implicit intent action will be Intent.ACTION\_PICK.
\\
Since we are expecting data to be sent back, the activity will be started with $startActivityForResult(...)$ along with a request code to be able to identify the sent back response/result.
\begin{lstlisting}
final Intent pickContactIntent = new Intent(Intent.ACTION_PICK, ContactsContract.Contacts.CONTENT_URI);
startActivityForResult(pickContactIntent, REQUST_CONTACT);
\end{lstlisting}

\subsubsection{The Receival of Data}
Inside $onActivityResult(...,...,...)$
\begin{lstlisting}
if (data == null) {
	break;
}

Uri contactUri = data.getData();
String[] queryFields = new String[] {
	ContactsContract.Contacts.DISPLAY_NAME
};
Cursor cursor = getActivity().getContentResolver().query(contactUri, queryFields, null, null, null);
try {
	if (cursor.getCount() == 0) {
		return;
	}

	cursor.moveToFirst();
	String suspect = cursor.getString(0);
	mCrime.setSuspect(suspect);
	mSuspectButton.setText(suspect);
} finally {
		cursor.close();
}
\end{lstlisting}

\subsubsection{Checking if the Device has a Contacts App}
Use the OS Package manager to check if the device has a contacts app.
\\
If it does not, and you request data from the contacts app, the app will crash.  It is therefore recommended to deactivate the functionality that uses requires this.
\begin{lstlisting}
PackageManager packageManager = getActivity().getPackageManager();
if (packageManager.resolveActivity(pickContactIntent, PackageManager.MATCH_DEFAULT_ONLY) == null) {
	mSuspectButton.setEnabled(false);
}
\end{lstlisting}
This request returns an instance of $ResolveInfo$ telling all about what the activity it found.

\subsection{Taking Pictures with intents}
All things Media related is defined in $MediaStore$.  It defines the public interfaces used in Android for interacting with common media.
\\
The camera intent is defined in here as $MediaStore.ACTION\_IMAGE\_CAPTURE$.
\\\\
By default $ACTION\_IMAGE\_CAPTURE$ will take a thumb-nail picture and return it inside the $Intent$ object returned in $onActivityResult(...)$
\\
For a full-resolution picture, you need to tell it where to store the file on the file system. 
\\
This can be completed by passing a Uri pointing to where you want to save the file in $MediaStore.EXTRA\_OUTPUT$.  This Uri will point to a location serviced by $FileProvider$.
\begin{lstlisting}
PackageManager packageManager = getActivity().getPackageManager();
mPhotoButton = (ImageButton) view.findViewById(R.id.crime_camera);
final Intent captureImageIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
boolean canTakePhoto = (mPhotoFile != null) && (captureImageIntent.resolveActivity(packageManager) != null);
mPhotoButton.setEnabled(canTakePhoto);
mPhotoButton.setOnClickListener(new View.OnClickListener() {
	@Override
	public void onClick(View view) {
		Uri uri = FileProvider.getUriForFile(getActivity(), "", mPhotoFile);
		captureImageIntent.putExtra(MediaStore.EXTRA_OUTPUT, uri);

		List<ResolveInfo> cameraActivities = getActivity().getPackageManager().queryIntentActivities(captureImageIntent, PackageManager.MATCH_DEFAULT_ONLY);

		for (ResolveInfo activity : cameraActivities) {
			getActivity().grantUriPermission(activity.activityInfo.packageName, uri, Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
		}

		startActivityForResult(captureImageIntent, REQUEST_PHOTO);
	}
});
\end{lstlisting}
\subsubsection{Declaring the Camera Feature}
To declare that the app uses the camera, add the following into $AndroidManifest.xml$:
\begin{lstlisting}
<uses-feature android:name="android.hardware.camera"
			android:required="false"/>
\end{lstlisting}

%%%%%%%%%%%%%%%%%%% File Storage %%%%%%%%%%%%%%%%%%%
\section{File Storage}
Can store files in out own private storage for the app.  This is the same location where the SQLite database is stored.  So your app is the only one able to access them.
\\
These files are access using the $Context$ class.
\\
The primary methods in the $Context$ class:
\begin{itemize}
	\item  $getFilesDir()$
\end{itemize}
To let other apps access files stored in this location, we can use a $ContentProvider$.
\\
This allows us to expose content URIs to other apps; which intern, allows us those apps to read and write to that specific URI.

\subsection{FileProvider}
When all that is required is to be able to receive a file from another application, a $FileProvider$ can be used instead of implementing an entire $ContentProvider$; which in this case would be classed as overkill.
\\
The first step is to declare a $FileProvider$ as a $ContentProvider$ hooked up to a specific authority.  This is done by adding a content provider declaration to $AndroidManifest.xml$
\\
The authority is a location where files can be saved to.
\\
This gives other apps a target to write to.
\begin{lstlisting}
<provider
	android:authorities="com.bgsoftwarestudios.criminalintent.fileprovider"
	android:name="android.support.v4.content.FileProvider"
	android:exported="false"
	android:grantUriPermissions="true" />
\end{lstlisting}
The $android:exported="false"$ attribute stops any app from using this provider except you and apps that you grant permission to.
\\
And the $android:grantUriPermissions="true" $ attribute allows us to give other apps permission to write to this URI when we send out an intent.
\subsubsection{Exposing/Telling the $FileProvider$ what files it is exposing}
To tell the $FileProvider$ what files to expose, create a new resource file $xml/files.xml$.
\\
You can create this initially by:
\begin{enumerate}
	\item Right-click on the $app/res$ directory.
	\item Select new $\rightarrow$ Android resource file.
	\item For Resource type select XML.
	\item Enter $files$ for the file name.
	\item Enter the flowing into the the xml file
\end{enumerate}
\begin{lstlisting}
<?xml version="1.0" encoding="utf-8"?>
<paths>
	<files-path
		name="crime_photos"
		path="."/>
</paths>
\end{lstlisting}
This declares the file paths that $FileProvider$ will use/expose internally.
\\
We then need to hook up the $files.xml$ to the $FileProvider$ by using a $meta-data$ tag in $AndroidManifest.xml$.
\subsubsection{Hooking up the paths description to the $FileProvider$ within $AndroidManifest.xml$}
Add a $meta-data$ element inside the provider:
\begin{lstlisting}
<provider
	android:authorities="com.bgsoftwarestudios.criminalintent.fileprovider"
	android:name="android.support.v4.content.FileProvider"
	android:exported="false"
	android:grantUriPermissions="true">
	<meta-data
		android:name="android.support.FILE_PROVIDER_PATHS"
		android:resource="@xml/files"/>
</provider>
\end{lstlisting}

\subsubsection{Revoking File write $FileProvider$ permissions}
When the picture is taken, the method $onActivityResult(...,...,...)$ is called.  So when the request comes back we can remove the file write permissions to that Uri for that external activity.
\begin{lstlisting}
Uri uri = FileProvider.getUriForFile(getActivity(), FILE_PROVIDER_AUTHORITY, mPhotoFile);
getActivity().revokeUriPermission(uri, Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
updatePhotoView();
\end{lstlisting}

%%%%%%%%%%%%%%%%%%% Bitmaps %%%%%%%%%%%%%%%%%%%
\section{Bitmaps}
Bitmaps store image data as literal pixel data
\subsection{Scaling Bitmaps}
A 16-megapixel, 24-bit camera image compressed as a JPG with a size of 5 MB, would be 48 MB as a bitmap.
\\
To shrink a bit map:
\begin{enumerate}
	\item scan the file to determine the size
	\item figure out how much it needs to be scaled for the desired dimensions.
	\item reread the file and construct the new bitmap.
\end{enumerate}
\begin{lstlisting}
public class PictureUtils {

	public static Bitmap getScaledBitmap(String path, int destWidth, int destHeight) {
		// Read in the dimentions of the image on disk
		BitmapFactory.Options options = new BitmapFactory.Options();
		options.inJustDecodeBounds = true;
		BitmapFactory.decodeFile(path, options);

		float srcWidth = options.outWidth;
		float srcHeight = options.outHeight;

		// Calculate how much to scale down by
		int inSampleSize = 1;
		if (srcHeight > destHeight || srcWidth > destWidth) {
			float heightScale = srcHeight / destHeight;
			float widthScale = srcWidth / destWidth;
			float scale = heightScale > widthScale ? heightScale : widthScale;
			inSampleSize = Math.round(scale);
		}

		options = new BitmapFactory.Options();
		options.inSampleSize = inSampleSize;

		// Read in and create final bitmap
		return BitmapFactory.decodeFile(path, options);
	}
}
\end{lstlisting}
The $inSampleSize$ determines how big each new pixel is relative to each old pixel.
\\
E.g. for a sample size of 2, one new pixel horizontally is equivalent to 2 old pixels horizontally; therefore, shrinking the bitmap horizontally by 2 (so the overall size will the one fourth).
\subsubsection{Very conservative scaling}
A very conservative scaling of bit map is to shrink it down to the size of an activity.  This ensures that the image will never be too small for the size of the activity; therefore, keeping a high enough quality/resolution.
\begin{lstlisting}
public static Bitmap getScaledBitmap(String path, @NonNull Activity activity) {
	Point size = new Point();
	activity.getWindowManager().getDefaultDisplay().getSize(size);
	return getScaledBitmap(path, size.x, size.y);
}
\end{lstlisting}

%%%%%%%%%%%%%%%%%%% Strings %%%%%%%%%%%%%%%%%%%
\section{Strings}
\subsection{Plurals}
\begin{lstlisting}
<plurals name="subtitle_plural">
	<item quantity="one">%1$d crime</item>
	<item quantity="other">%1$d crimes</item>
</plurals>
\end{lstlisting}
To retrieve/use the string:
\begin{lstlisting}
getResources().getQuantityString(R.plurals.subtitle_plural, crimeSize, crimeSize);
\end{lstlisting}

\subsection{Percentages}
\begin{lstlisting}
<string name="playback_speed_percentage">PlayBack Speed: %d%%</string>
\end{lstlisting}

\subsection{Formatted Strings}
\subsubsection{Strings with values embedded}
\begin{lstlisting}
<string name="welcome_messages">Hello, %1$s! You have %2$d new messages.</string>
\end{lstlisting}
\begin{lstlisting}
String text = getString(R.string.welcome_messages, username, mailCount);
\end{lstlisting}
Use \it{\%1\$s} for \it{strings} and \it{\%1\$d}  for decimals.

%%%%%%%%%%%%%%%%%%% Intents %%%%%%%%%%%%%%%%%%%
\section{Intents}
\subsection{Starting n activity in a new task}
\begin{lstlisting}
ActivityInfo activityInfo = resolveInfo.activityInfo;
Intent intent = new Intent(Intent.ACTION_MAIN)
				.setClassName(activityInfo.applicationInfo.packageName, activityInfo.name)
				.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(intent);
\end{lstlisting}

%%%%%%%%%%%%%%%%%% Two-Pane Master-Detail %%%%%%%%%%%%%%%%%
\section{Two-Pane Master-Detail}
This is most commonly used for tablets.  
\\
However, you swill commonly require different layout for on phone vs tablet.
\\
To do this, use a alias resource.
\subsection{Alias Resource}
In $res/values$, create a resource file for the default (phone) and list the layout to be used.  Call this file $refs.xml$.
\begin{lstlisting}
<?xml version="1.0" encoding="utf-8"?>
<resources>
	<item name="activity_masterdetail" type="layout">@layout/activity_fragment</item>
</resources>
\end{lstlisting}
Then for the layouts that are needed to be used for larger screen sizes include the Smallest Screen Width qualifier with a value of 600.
\\
Call this file $refs.xml$ also.
\begin{lstlisting}
<?xml version="1.0" encoding="utf-8"?>
<resources>
	<item name="activity_masterdetail" type="layout">@layout/activity_twopane</item>
</resources>
\end{lstlisting}
This will display the later when the minimum screen dimension is 600dp.
\\
To use this in code, refer to the layout you want using the name of the item.
\\
The file/layout that is then displayed/used is declared as the string in the $item$ element.

\subsection{Determining Device size}
page 335.


\section{RecyclerView}
\subsection{Item cell padding}
\begin{lstlisting}
package com.bengavan.android.recyclerviewtesting;

import android.graphics.Rect;
import android.view.View;

import androidx.annotation.NonNull;
import androidx.recyclerview.widget.RecyclerView;

public class RecyclerViewItemSpacing extends RecyclerView.ItemDecoration {
	
	private int left = 0;
	private int top = 0;
	private int right = 0;
	private int bottom = 0;
	
	public RecyclerViewItemSpacing(int spacing) {
		new RecyclerViewItemSpacing(spacing, spacing, spacing, spacing);
	}
	
	public RecyclerViewItemSpacing(int left, int top, int right, int bottom) {
		this.left = left;
		this.top = top;
		this.right = right;
		this.bottom = bottom;
	}
	
	@Override
	public void getItemOffsets(@NonNull Rect outRect, @NonNull View view, @NonNull RecyclerView parent, @NonNull RecyclerView.State state) {
		outRect.left = left;
		outRect.top = top;
		outRect.right = right;
		outRect.bottom = bottom;
	}
}
\end{lstlisting}

\subsection{Swipe to delete}
The main components to fulfill this:
\begin{itemize}
	\item \it{ItemTouchHelper}
	\subitem This is attached to the \it{RecyclerView} and watches for swipes
	
	\item \it{ItemTouchHelper.SimpleCallback} 
	\subitem This is passed into \it{ItemTouchHelper}'s constructor and contains the code that will run once the item is swiped.
\end{itemize}

\subsubsection{Creating \it{ItemTouchHelper.SimpleCallback}}
Create a new class that extends \it{ItemTouchHelper.SimpleCallback}:
\begin{lstlisting}
public class SwipeToDeleteCallback extends ItemTouchHelper.SimpleCallback {
	
	private Adapter adapter;
	
	public SwipeToDeleteCallback(Adapter adapter) {
		super(0, ItemTouchHelper.LEFT | ItemTouchHelper.RIGHT);
		this.adapter = adapter;
	}
}
\end{lstlisting}
The first parameter in the \it{super(...)} call adds support for dragging the item up or down; so leaving it \it{0} will prevent this.
\\
The send paramenter is for left and right, which we do want both; hence the or of both left and right.
\\
We also take in a reference to the adapter for the \it{RecyclerView}.
\\\\
We then need to override two methods:
\begin{lstlisting}
@Override
public boolean onMove(@NonNull RecyclerView recyclerView, @NonNull RecyclerView.ViewHolder viewHolder, @NonNull RecyclerView.ViewHolder target) {
	return false;
}

@Override
public void onSwiped(@NonNull RecyclerView.ViewHolder viewHolder, int direction) {
	
}
\end{lstlisting}
The \it{onMove(...)} override is not required; however, it is required to be overridden.
\\
The \it{onSwiped(...)} override is what we are going to use to implement swipe to delete.
\\\\
Creating a background for when the user swipes:
\begin{lstlisting}
@Override
public void onChildDraw(@NonNull Canvas c, @NonNull RecyclerView recyclerView, @NonNull RecyclerView.ViewHolder viewHolder, float dX, float dY, int actionState, boolean isCurrentlyActive) {
	super.onChildDraw(c, recyclerView, viewHolder, dX, dY, actionState, isCurrentlyActive);
	
	View itemView = viewHolder.itemView;
	
	int backgroundCornerOffset = 20; // So the background is behind the rounded corners of itemView
	
	int iconMargin = (itemView.getHeight() - icon.getIntrinsicHeight()) / 2;
	int iconTop = itemView.getTop() + iconMargin;
	int iconBottom = iconTop + icon.getIntrinsicHeight();
	
	if (dX > 0) { // Swiping to the right
		int iconLeft = itemView.getLeft() + iconMargin + icon.getIntrinsicWidth();
		int iconRight = itemView.getLeft() + iconMargin;
		
		icon.setBounds(iconLeft, iconTop, iconRight, iconBottom);
		
		background.setBounds(itemView.getLeft(), itemView.getTop(),
		itemView.getLeft() + ((int) dX) + backgroundCornerOffset,
		itemView.getBottom());
		
	} else if (dX < 0) { // Swiping to the left
		int iconLeft = itemView.getRight() - iconMargin - icon.getIntrinsicWidth();
		int iconRight = itemView.getRight() - iconMargin;
		icon.setBounds(iconLeft, iconTop, iconRight, iconBottom);
		background.setBounds(itemView.getRight() + ((int) dX) + - backgroundCornerOffset,
		itemView.getTop(), itemView.getRight(), itemView.getBottom());
	} else { // View is un-swiped
		background.setBounds(0,0,0,0);
	}
	
	background.draw(c);
	icon.draw(c);
}
\end{lstlisting}

\subsection{Press and hold to change order}

\subsection{Rounded Corners}
Add a drawable resource (in \it{res/drawable/}):
\begin{lstlisting}
<shape xmlns:android="http://schemas.android.com/apk/res/android"
	android:shape="rectangle">
	
	<corners android:radius="5dp"/>
	
	<solid android:color="@android:color/holo_blue_light" />

</shape>
\end{lstlisting}
then set it as the background of the list item layout.

%%%%%%%%%%%%%%%%%%% TextView %%%%%%%%%%%%%%%%%%%
\section{TextView}

\subsection{Horizontal Scroll (Automatically)}
To make a \it{TextView}'s text scroll automatically (like spotify) the textView XML declaration is:
\begin{lstlisting}
	content...
\end{lstlisting}
and to activate we need to set ..... to true

%%%%%%%%%%%%%%%%%%% Localization %%%%%%%%%%%%%%%%%%%
\section{Localization}
See chapter 18

%%%%%%%%%%%%%%%%%%% Accessibility %%%%%%%%%%%%%%%%%%%
\section{Accessibility}
\subsection{TalkBack}
TalkBack if an Android screen reader made by Google.
\\\\
See Chapter 19.

%%%%%%%%%%%%%%%%%%% Assets %%%%%%%%%%%%%%%%%%%
\section{Styles and Themes}
\subsection{Styles}
Declared inside the \textit{styles.xml} file
\begin{lstlisting}
<style name="BeatBoxButton">
	<item name="android:background">@color/dark_blue</item>
</style>
\end{lstlisting}

\subsection{Style Inheritance}
The second style declaration of \textit{BeatBoxButton.Strong} will inherit all of the items declared in the style declared above it - \textit{BeatBoxButton}.
\begin{lstlisting}
<style name="BeatBoxButton">
	<item name="android:background">@color/dark_blue</item>
</style>

<style name="BeatBoxButton.Strong">
	<item name="android:textStyle">bold</item>
</style>
\end{lstlisting}

\subsection{Themes}
Are applied to all objects across the app.

\subsubsection{android:windowBackground}
Changes the color of the background.
\\
Need to use the android name space since the 'windowBackground' attribute that we are overriding, is declared in the Android OS.

\subsubsection{Overriding themes}
Specifying the parent in the style name only works when the parent theme exists in the same package.
\\
So specify the parent in the name when it exists in the same package (one of your own).  But when it crosses over to a different package (e.g. Android OS, AppCompat), use the explicit $ parent="" $ attribute.

\subsubsection{Accessing Theme Attributes}
To access attributes declared in a theme, e.g. to access a color declared in a them, use the $ ? $ syntax:
\begin{lstlisting}
	android:background="?attr/colorAccent"
\end{lstlisting}
This retreivenes the color that the attribute 'colorAccent' in the theme points to.

%%%%%%%%%%%%%%%%%%% Assets %%%%%%%%%%%%%%%%%%%
\section{Assets}
\subsection{Why Assets over Dependencies}
More basic/less overhead.
\\
For sound files, we can store them in the 'res/raw' folder withing 
\\
The resource system is limited to a flat hierarchy, unlike assets which can implement its own custom file structure.  This therefore is more organized when there are large amounts of assets.
\\
Resources do not allow you to read in multiple files at once - you have to refer to each file independently (unlike assets where we can get the file list for a folder and then  loop through each asset, retrieving each one at a time).  Resources are given ids such as R.raw.file.


\subsection{Creating an Assets Folder}
To create an assets folder for your app:
\begin{itemize}
	\item Go to the Android option for the folder/files layout 
	\item Right-click $\rightarrow$ New $\rightarrow$ Folder (Last section of the menu with the android guy as the symbol to the left of the options)$\rightarrow$ Assets Folder.
	\item Keep 'Change Folder Location' unchecked.
	\item select 'main' for 'Target Source Set'
	\item Press finish.
	\item Proceed to create sub directories for organization of your assets.
\end{itemize}

\subsection{Accessing Assets}
Assets are accessed using the $AssetsManager$ class.
\subsubsection{Getting an $AssetsManager$}
You get get at $AssetsManager$ from any context.

\subsubsection{Getting assets files names}
\begin{lstlisting}
private void loadSounds() {
	String[] soundNames;
	try {
		soundNames = assetManager.list(SOUNDS_FOLDER);
		Log.i(TAG, "Found " + soundNames.length + " sounds");
	} catch (IOException ioe) {
		Log.e(TAG, "Could not list assets", ioe);
		return;
	}
}
\end{lstlisting}
where $SOUNDS\_FOLDER$ the directory within the Assets folder that you want to access.

\subsection{SoundPool}
$SoundPool$ can load lots of sound files into memory and control the maximum number of sounds that are playing back at one time.
\\
A benefit of $SoundPool$ over other methods of playing sounds is that you you ask it to play, there is very little lag and starts to play almost immediately.
\\
A trade off is that you are required to load the sound before it is played.
\subsubsection{Creating a SoundPool}
The $SoundPool$ constructor takes the maximum number of sounds that can be played at any one time, the type of $AudioManager$ you require (for music use $STREAM_MUSIC$), and the third is the sample rate converter (the documentation says it is ignored).
\begin{lstlisting}
soundPool = new SoundPool(MAX_SOUNDS, AudioManager.STREAM_MUSIC, 0);
\end{lstlisting}
If you are playing the maximum number of sounds and then you try to play another, the oldest sound will be stopped to make space for the new sound being added.
\\
The AudoManager.*** also specifies what audio volume is adjusted when it is playing (specifies what volume is used to play that sound).

\subsubsection{Loading Sounds}
Give each sound a unique ID - typically an integer value.  Use $Integer$ so that it can have an unspecified value of $null$.
\begin{lstlisting}
private void load(@NotNull Sound sound) throws IOException {
	AssetFileDescriptor assetFileDescriptor = assetManager.openFd(sound.getAssetPath());
	int soundId = soundPool.load(assetFileDescriptor, 1); // Loads a file into soundPool for later play back.
	sound.setSoundId(soundId);
}
\end{lstlisting}
$soundPool.load(...)$ loads a file into $soundPool$ for later playback.  It also returns an ID to keep track of it so it is able to play it or unload it at a later time.
\\\\
$assetManager.openFd(...)$ throws the $IOException$.

\subsubsection{Playing Sounds}
\begin{lstlisting}
soundPool.play(soundId, 1f, 1f, 1, 0, 1f);
\end{lstlisting}
'priority' is ignored.
\\
For 'loop', '-1' causes it to loop forever.  0 = do not loop.

%%%%%%%%%%%%%%%%%%% XML Drawables %%%%%%%%%%%%%%%%%%%%%
\section{XML Drawables}
\begin{itemize}
	\item not density specific, so are placed/stored in the default drawable folder instead of a density-specific one.
\end{itemize}
\subsection{What is a Drawable}
Android calls anything that is intended to be drawn on the screen a drawable.

\subsection{State List Drawables}
Is a drawable reasource file that points to other drawable resource files for different states.  This file if set as the resource on the object.
\\\\
For example, a button with two states - pressed and normal (not pressed):
\\
In the resource file that is allocated to the object is a selector with 2 items - one for each of the states:
\begin{lstlisting}
<selector xmlns:android="http://schemas.android.com/apk/res/android">

	<item android:drawable="@drawable/button_beat_box_pressed"
		android:state_pressed="true"/>
	<item android:drawable="@drawable/button_beat_box_normal"/>

</selector>
\end{lstlisting}
Then in the first file that is pointed to:
\begin{lstlisting}
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
	android:shape="oval">

	<solid
		android:color="@color/red"/>

</shape>
\end{lstlisting}
and in the second:
\begin{lstlisting}
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
	android:shape="oval">

	<solid
		android:color="@color/dark_blue"/>

</shape>
\end{lstlisting}
For the button, there are different states, including disabled, focused, and activated.

\subsection{shape drawables}

\subsection{layer list drawables}
Allows two XML drawables to be combined into one.
\begin{lstlisting}
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">

	<item>
		<shape
			android:shape="oval">

			<solid
				android:color="@color/red"/>

		</shape>
	</item>

	<item>
		<shape
			android:shape="oval">

			<stroke
				android:width="4dp"
				android:color="@color/dark_red"/>
		</shape>
	</item>

</layer-list>


\end{lstlisting}

%%%%%%%%%%%%%%%%%%% Custom Views %%%%%%%%%%%%%%%%%%%%%
\section{Custom Views}
Two broad categories:
\begin{itemize}
	\item Simple
	\subitem Has no child sub-views (even though it may be complex in of it self).
	\subitem Will almost always perform custom rendering.
	\subitem Subclass \it{View}
	 
	\item Composite
	\subitem Composed by other view objects.
	\subitem Typically manage child views but do not perform custom rendering.
	\subitem Rendering is delegated to each child view.
	\subitem Subclass an appropriate layout class, such as \it{FrameLayout}
\end{itemize}

\subsection{Custom Simple View}
A basic skeletal custom simple view:
\begin{lstlisting}
import android.content.Context;
import android.util.AttributeSet;
import android.view.View;

public class BoxDrawingView extends View {
	
	// Used when inflating view in code
	public BoxDrawingView(Context context) {
		super(context);
	}
	
	// Used when inflating view from xml
	public BoxDrawingView(Context context, AttributeSet attrs) {
		super(context, attrs);
	}
}
\end{lstlisting}

\subsubsection{Background Color}
To get the color for \it{resources}
\begin{lstlisting}
ResourcesCompat.getColor(getResources(), R.color.your_color, your_theme);
\end{lstlisting}
where \it{your\_theme} can be \it{null}.

\subsection{Handling Touch Events}
One way to implement touch listening is to implement the \it{View.OnTouchListener} interface by using the method:
\begin{lstlisting}
	public void setOnTouchListener(OnTouchListener l)
\end{lstlisting}
However, since the view is a subclass of \it{View}, we can override the \it{View} method:
\begin{lstlisting}
	public boolean onTouchEvent(MotionEvent event) 
\end{lstlisting}

\subsubsection{\it{MotionEvent}}
The \it{MotionIntent} includes its location and its action.  The action describes the stage of the event and can have the following values:
\begin{center}
	\begin{tabular}{| c | c |} 
		\hline
		Action Constants  & Description  \\ [0.5ex] 
		\hline 
		ACTION\_DOWN & User's finger touches the screen   \\ [1ex]
		ACTION\_MOVE & User' moves finger on the screen   \\ [1ex]
		ACTION\_UP & User lifts finger off the screen  \\ [1ex]
		ACTION\_CANCEL & A parent view has intercepted the touch event   \\  [1ex] 
		\hline
	\end{tabular}
\end{center}
This can be retrieved from the event by calling:
\begin{lstlisting}
	public final int getAction()
\end{lstlisting}
Basic touch event handling:
\begin{lstlisting}
@Override
public boolean onTouchEvent(MotionEvent event) {
	PointF current = new PointF(event.getX(), event.getY());
	String action = "";
	
	switch (event.getAction()) {
		case MotionEvent.ACTION_DOWN:
			action = "ACTION_DOWN";
			break;
		case MotionEvent.ACTION_MOVE:
			action = "ACTION_MOVE";
			break;
		case MotionEvent.ACTION_UP:
			action = "ACTION_UP";
			break;
		case MotionEvent.ACTION_CANCEL:
			action = "ACTION_CANCEL";
			break;
	}
	
	Log.i(TAG, "onTouchEvent: " + action + " at: (" + current.x + ", " + current.y + ")");
	return true;
}
\end{lstlisting}

\subsection{Rendering inside \it{onDraw(Canvas)}}
The two main classes are:
\begin{itemize}
	\item \it{Canvas}
	\subitem Has all the drawing operations you can perform.
	\subitem line, circle, word, or a rectangle
	
	\item \it{Paint} 
	\subitem Determines how these operations are performed.
	\subitem Whether shapes are filled, what fonts are used, and what.
\end{itemize}

\section{Animation}
There are three properties:
\begin{itemize}
	\item View rotation
	\item View scaling
	\item View translation
\end{itemize}

\subsection{Interpolation}
\subsubsection{Setting the interpolator}
\begin{lstlisting}
	heightAnimator.setInterpolator(new AccelerateInterpolator());
\end{lstlisting}

%%%%%%%%%%%%%%%%%%% 9-Patch Images %%%%%%%%%%%%%%%%%%%%%
\section{9-Patch Images}
See Page 450 

%%%%%%%%%%%%%%%%%%% AsyncTasks %%%%%%%%%%%%%%%%%%%%%
\section{AsyncTasks}
\subsection{\it{AsyncTasks.cancel(boolean)}}
\subsubsection{\it{.cancel(true)}}
\textit{.cancel(true)} is the more severe way of stopping the task.
\\
Will just interrupt the thread.
\\
not advisable, should avoid it if you can
\subsubsection{\it{.cancel(false)}}
The better way of doing things.
\\
Just sets \textit{isCancelled()} to true.  So the \textit{AsyncTask} can then check \textit{isCancelled()} inside \textit{doInBackground(...)} and elect to finish prematurely.

\subsection{message queue}
A \it{message loop} consists of a \it{thread} and a \it{looper}

\subsection{Looper}
The \it{looper} is the object that manages a thread's message queue.
\\
Multiple \it{handlers}  can be attached to one \it{looper}.	

\subsection{Handler}

\subsection{Background Thread}
\subsubsection{Assembling a Background Thread}

\subsection{\it{ConcurrentHashMap}}
\it{ConcurrentHashMap} is a thread-safe version of \it{HashMap}.


%%%%%%%%%%%%%%%%%%% HTTP %%%%%%%%%%%%%%%%%%%%%
\section{HTTP}
!!!!!!!!!!!!!!!!!!!!!!!!YOU NEED TO HAVE THE INTERNET PERMISSION!!!!!!!!!!!!!!!!!!!!!!!!
\subsection{Make get requests}
\begin{lstlisting}
public byte[] getUrlBytes(String urlString) throws IOException {
	URL url = new URL(urlString);
	HttpURLConnection connection = (HttpURLConnection) url.openConnection();

	try {
		ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
		InputStream inputStream = connection.getInputStream();

		if (connection.getResponseCode() != HttpURLConnection.HTTP_OK) {
			throw new IOException(connection.getResponseMessage() + ": with " + urlString);
		}

		int bytesRead = 0;
		byte[] buffer = new byte[1024];
		while ((bytesRead = inputStream.read(buffer)) > 0) {
			outputStream.write(buffer, 0, bytesRead);
		}
		outputStream.close();
		return outputStream.toByteArray();
	} finally {
		connection.disconnect();
	}
}

public String getUrlString(String urlString) throws IOException {
	return new String(getUrlBytes(urlString));
}
\end{lstlisting}

\subsection{Connecting to local sever from emulator}
Use the IP address of \it{10.0.2.2} instead of \it{localhost} 
\\
This is due to that when using \it{localhost}, it is trying to connect to a that address on the actual emulator. 

\subsection{building a Url String}
\begin{lstlisting}
try {
	String url = Uri.parse("https://www.flickr.com/services/rest/")
		.buildUpon()
		.appendQueryParameter("method", "flickr.photos.getRecent")
		.appendQueryParameter("api_key", API_KEY)
		.appendQueryParameter("format", "json")
		.appendQueryParameter("nojsoncallback", "1")
		.appendQueryParameter("extras", "url_s")
		.build().toString();
	String jsonString = getUrlString(url);
	Log.i(TAG, "fetchItems: Retreived JSON: " + jsonString);
} catch (IOException ioe) {
	Log.e(TAG, "fetchItems: Failed to fetch items", ioe);
}
\end{lstlisting}

\subsection{Parsing JSON}

%%%%%%%%%%%%%%%%%%% LruCache  %%%%%%%%%%%%%%%%%%%%%
\section{\it{LruCache}}
A cache of a defined size of the format of a key-value map.
\subsection{Creating a new Cache}
\begin{lstlisting}
private final LruCache<K, V> thumbnailCache;
\end{lstlisting}
of size 40MiB:
\begin{lstlisting}
int cacheSize = 40 * 1024 * 1024; // 40MiB
thumbnailCache = new LruCache<String, Bitmap>(cacheSize) {
	@Override
	protected int sizeOf(String key, Bitmap value) {
		return value.getByteCount();
	}
};
\end{lstlisting}

\subsection{Retrieval from the Cache}
\begin{lstlisting}
V value  = cache.get(key)
\end{lstlisting}
The object retrieved is already of the type that was \it{put} and therefore does not require casting.

\subsection{Adding item to cache}
\begin{lstlisting}
private void addToCache(String key, Bitmap bitmap) {
	synchronized (thumbnailCache) {
		if (thumbnailCache.get(key) == null) {
			thumbnailCache.put(key, bitmap);
		}
	}
}
\end{lstlisting}
To be thread-safe, the cache object has to be declared as final with any putting/getting carried out within the scope of \it{synchronized}.
\\
Before adding, it will be advisable for most implementations to check that there is not a value already stored for that key; otherwise, it will be overridden.

%%%%%%%%%%%%%%%%%%% SearchView %%%%%%%%%%%%%%%%%%%%%
\section{\it{SearchView}}
A \it{SeachView} is an \it{action view} class.
\\
It can be embedded into any \it{view} including a \it{ToolBar}.

%%%%%%%%%%%%%%%%%% SharedPreferences %%%%%%%%%%%%%%%%%%%%%
\section{SharedPreferences}
Should use 
\begin{lstlisting}
PreferenceManager.getDefaultSharedPreferences(context)
\end{lstlisting}
from the \it{androidx} library instead of 
\begin{lstlisting}
	content...
\end{lstlisting}
This will use the default settings which include that the preferences are only accessible from within the app.
\begin{lstlisting}
public class QueryPreferences {
	
	private static final String TAG = "QueryPreferences";
	private static final String PREF_SEARCH_QUERY = "searchQuery";
	
	public static String getStoredQuery(Context context) {
		return PreferenceManager.getDefaultSharedPreferences(context)
		.getString(PREF_SEARCH_QUERY, null);
	}
	
	public static void setStoredQuery(Context context, String query) {
		PreferenceManager.getDefaultSharedPreferences(context)
		.edit()
		.putString(PREF_SEARCH_QUERY, query)
		.apply();
	}
}
\end{lstlisting}

%%%%%%%%%%%%%%%%%% Background Services %%%%%%%%%%%%%%%%%%%%
\section{Background Services}
To be able to run code/do something in the background not requiring a view, a \it{service} is required.
\\
\it{Service} is a subclass of \it{Context}
\subsection{\it{IntentService}}
An \it{IntentService} is probably the most common service.
\subsubsection{Basic Skeletal example}
\begin{lstlisting}
public class PollService extends IntentService {
	private static final String TAG = "PollService";
	
	public static Intent newIntent(@NonNull Context context) {
		return new Intent(context, PollService.class);
	}
	
	public PollService() {
		super(TAG);
	}
	
	@Override
	protected void onHandleIntent(Intent intent) {
		Log.i(TAG, "onHandleIntent: Recieved an Intent: " + intent);
	}
}
\end{lstlisting}

\subsection{\it{commands}}
A service's intents and called \it{commands}.  
\\
Each \it{command} is an instruction for the service to do something.
\\
Since services respond to intents, they must declared in \it{AndroidManifest/xml}, just like activities do.
Like activities

\subsection{Safe background networking}
Since you are carrying out networking in the background, android provides an option to disable background networking to save on power consumption and performance improvements.  
\\
As a consequence of this, you should always check with \it{ConnectivityManager} that the network is available.
\subsubsection{Checking for background networking availability}
\begin{lstlisting}
//need to figure out undeprecated method
private boolean isNetworkAvailableandConnected() {
	ConnectivityManager cm = (ConnectivityManager) getSystemService(CONNECTIVITY_SERVICE);
	// TODO: Use un-deprecated method then add to LATEX document
	boolean isNetworkAvailable = (cm.getActiveNetworkInfo() != null);
	boolean isNetworkConnected = (isNetworkAvailable && cm.getActiveNetworkInfo().isConnected());
	
	return isNetworkConnected;
}
\end{lstlisting}

\subsection{\it{AlarmManager}}
\it{AlarmManager} is a system service that can send intents for you.
\\
If you used \it{handler}s instead, if the user closes the app (i.e. navigates away from all activities of the app) the system will shutdown that process which also results in all of the \it{Handler}'s \it{messages} to go kaput with it.
\\
To request \it{AlarmPanager} to send an intent, a \it{PendingIntent} is used which is sent to other components of the system, such as \it{AlarmManager}. 
\\
You will want to turn the alarm on and off from the UI via an activity or a fragment.

%%%%%%%%%%%%%%%%%%% Notifications %%%%%%%%%%%%%%%%%%%%%
\section{Notifications}
\subsection{Creating a notification}
\begin{lstlisting}
Resources resources = getResources();
Intent photoGalleryIntent = PhotoGalleryActivity.newIntent(this);
PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, photoGalleryIntent, 0);

Notification notification = new NotificationCompat.Builder(this)
		.setTicker(resources.getString(R.string.new_pictures_title))
		.setSmallIcon(android.R.drawable.ic_menu_report_image)
		.setContentTitle(resources.getString(R.string.new_pictures_title))
		.setContentText(resources.getString(R.string.new_pictures_text))
		.setContentIntent(pendingIntent)
		.setAutoCancel(true)
		.build();

NotificationManagerCompat notificationManager = NotificationManagerCompat.from(this);
notificationManager.notify(0, notification);
\end{lstlisting}

\section{Broadcast Intents}
\subsection{Regular \it{Intents} vs \it{Broadcast Intents}}
Broadcast intents are like regular intents; however, unlike regular intents, \it{Broadcast Intents} can be sent once and received by multiple components, called \it{broadcast receivers}.
\\\\
Even though \it{broadcast receivers} can receive explicit intents, they are very rarely used in this manner.  Instead, they are used to respond to \it{broadcast intents}.  This is put down to that \it{explicit intents} can only have one receiver.

\subsection{Receiving a system Broadcast}
\subsubsection{Waking Up on Boot}
You can detect when a boot (turned on) is completed by listening for a broadcast intent with the \it{BOOT\_COMPLETED} action.
\\
This can be listened for by creating and registering a standalone \it{broadcast receiver} that filters for the appropriate action.

\subsubsection{Creating and Registering a standalone receiver}
A \it{standalone receiver} is declared in the \it{AndroidManifest.xml}.  This means that it can be activated, even if the app process is dead.  This is compared to a \it{dynamic receiver} where it is tied to the life-cycle of the app. 
\\
If a \it{standalone receiver} is not registered with the system (via \it{AndroidManifest.xml}), just like an activity or service, it will not be able to receive any intents.
\\
Basic Example of a \it{standalone receiver}:
\begin{lstlisting}
	content...
\end{lstlisting}
Registration of a \it{standalone receiver} inside the \it{application} tag:
\begin{lstlisting}
<receiver android:name=".StartupReceiver">
	<intent-filter>
		<action android:name="android.intent.action.BOOT_COMPLETED" />
	</intent-filter>
</receiver>
\end{lstlisting}
Also requires the permission:
\begin{lstlisting}
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
\end{lstlisting}

\subsection{Sending Broadcast Intents}
\begin{lstlisting}
private static final String ACTION_SHOW_NOTIFICATION = "com.bengavan.photogallery.SHOW_NOTIFICATION";
\end{lstlisting}
\begin{lstlisting}
sendBroadcast(new Intent(ACTION_SHOW_NOTIFICATION));
\end{lstlisting}

\subsection{\it{Dynamic Broadcast Receiver}}
When you create a \it{dynamic receiver}, it should be registered on the fragment start and unregistered when the fragment is ended
\subsubsection{Register}
\it{Dynamic Broadcast Receiver}s are registered by calling \it{registerReceiver(BroadcastReceiver)}.

\begin{lstlisting}
public abstract class VisibleFragment extends Fragment {
	
	private static final String TAG = "VisibleFragment";
	
	@Override
	public void onStart() {
		super.onStart();
		IntentFilter intentFilter = new IntentFilter(PollService.ACTION_SHOW_NOTIFICATION);
		getActivity().registerReceiver(onShowNotification, intentFilter);
	}
	
	@Override
	public void onStop() {
		super.onStop();
		getActivity().unregisterReceiver(onShowNotification);
	}
	
	private BroadcastReceiver onShowNotification = new BroadcastReceiver() {
		@Override
		public void onReceive(Context context, Intent intent) {
			Toast.makeText(getActivity(), "Got a broadcast: " + intent.getAction(), Toast.LENGTH_LONG).show();
		}
	};
}
\end{lstlisting}

So that only your app can receive these broadcasts, create a permission and pass it to the broadcaster and receiver.
\\\\
To define a permission in \it{AndroidManifest.xml}
\begin{lstlisting}
<permission android:name="com.bengavan.photogallery.PRIVATE"
		android:protectionLevel="signature" />
\end{lstlisting}

\begin{lstlisting}
getActivity().registerReceiver(onShowNotification, intentFilter, PollService.PERM_PRIVATE, null);
\end{lstlisting}

\subsubsection{Un-Register}
\it{Dynamic Broadcast Receiver} is unregistered by calling \it{unregisterReceiver(BroadcastReceiver)}.

\subsection{\it{IntentFilter}}
\it{IntentFilter} can be created in code as well as expressed in xml by using \it{addCategory(String)}, \it{addAction(String)}, \it{addDataPath(String)}, and so on.
\begin{lstlisting}
IntentFilter intentFilter = new IntentFilter(PollService.ACTION_SHOW_NOTIFICATION);
\end{lstlisting}

\subsection{For longer running tasks}
For longer tasks, you can still use a broadcast receiver; however, in that small window of opportunity, start a service (which can run as long as required to complete the task) (it can also go off the main thread)
\\\\
Can use \it{BroadcastReceiver.goAsync()} to ...

%%%%%%%%%%%%%%%%%%% Location %%%%%%%%%%%%%%%%%%%%%
\section{Location}
\subsection{Requirements}
To use Google play services, you need to have the following dependency:
\begin{lstlisting}
    implementation 'com.google.android.gms:play-services-location:17.0.0'
\end{lstlisting}
Google play services are available/stored in the Google Play store app.  Therefore, Google Play Services can only work with apps that are installed on devices with the play store app installed.  Since most apps are installed through the play store, it is almost a guarantee that the app will be installed on those devices.  It is however, advisable to check that Play services are available.

\subsubsection{Checking Play Services are Available} 
\begin{lstlisting}
private static final int REQUEST_ERROR = 0;

@Override
protected void onResume() {
	super.onResume();
	
	GoogleApiAvailability apiAvailability = GoogleApiAvailability.getInstance();
	int errorCode = apiAvailability.isGooglePlayServicesAvailable(this);
	
	if (errorCode != ConnectionResult.SUCCESS) {
		Dialog errorDialog = apiAvailability.getErrorDialog(this, errorCode, REQUEST_ERROR, new DialogInterface.OnCancelListener() {
			@Override
			public void onCancel(DialogInterface dialogInterface) {
				finish();
			}
		});
		errorDialog.show();
	}
}
\end{lstlisting}

\subsubsection{Location Permissions}
For location requests, there are two types: \it{FINE\_LOCATION} and \it{COARSE\_LOCATION}. 
Fine location uses GPS and Coarse location uses Wi-Fi and cell towers.
\\
To access these, the following permissions are required:
\begin{lstlisting}
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.INTERNET" />
\end{lstlisting}
Both \it{FINE\_LOCATION} and \it{COARSE\_LOCATION} are dangerous permissions; therefore, a run-time request is required.

\subsubsection{\it{GoogleApiClient}}
To get a client withing \it{onCreate(Bundle)}:
\begin{lstlisting}
client = new GoogleApiClient.Builder(getActivity())
		.addApi(LocationServices.API)
		.build();
\end{lstlisting}
You should connect and disconnect in \it{onStart()} and \it{onStop()} respectively.
\begin{lstlisting}
@Override
public void onStart() {
	super.onStart();
	client.connect();
}

@Override
public void onStop() {
	super.onStop();	
	client.disconnect();
}
\end{lstlisting}
If the app is not connected to a client, it will not be able to do anything location related.
\\
If you want to get callbacks when the connection to the client is successful, suspended, or failed; add a \it{ConnectionCallBacks}:
\begin{lstlisting}
client = new GoogleApiClient.Builder(getActivity())
		.addApi(LocationServices.API)
		.addConnectionCallbacks(new GoogleApiClient.ConnectionCallbacks() {
			@Override
			public void onConnected(@Nullable Bundle bundle) {
				getActivity().invalidateOptionsMenu();
			}
			
			@Override
			public void onConnectionSuspended(int i) {
				
			}
		})
		.addOnConnectionFailedListener(new GoogleApiClient.OnConnectionFailedListener() {
			@Override
			public void onConnectionFailed(@NonNull ConnectionResult connectionResult) {
				Log.i(TAG, "onConnectionFailed: GoogleApiClient connection failed: " + connectionResult.toString());
			}
		})
		.build();
\end{lstlisting}

\subsection{Getting a Location Fix}
To get the location, a \it{LocationRequest} is used.  It has the following parameters:
\begin{center}
	\begin{tabular}{| c | c |} 
		\hline
		Parameters  & Description  \\ [0.5ex] 
		\hline 
		\it{interval} & how frequestly the location should be updated   \\ [1ex]
		\it{number of updates} & how many times the location should be updated   \\ [1ex]
		\it{priority} & How Android should priorities battery life against accuracy to satisfy yout request   \\ [1ex]
		\it{expiration} & whether the request should expire, and if so, when  \\  [1ex] 		
		\it{smallest displacement} & The smallest amount the devices should move (in meters) to trigger a location update  \\  [1ex] 
		\hline
	\end{tabular}
\end{center}
\begin{lstlisting}
	content...
\end{lstlisting}

\subsubsection{Checking You have location permissions}
Since  \it{FINE\_LOCATION} and \it{COARSE\_LOCATION} are both grouped under the location permission, you only have to check that you have permission for one.
\begin{lstlisting}
private boolean hasLocationPermission() {
	int result = ContextCompat.checkSelfPermission(getActivity(), LOCATION_PERMISSIONS[0]);
	return (result == PackageManager.PERMISSION_GRANTED);
}
\end{lstlisting}

\subsubsection{Requesting location permissions}
To request for location permissions at run-time, call the method:
\begin{lstlisting}
public final void requestPermissions(@NonNull String[] permissions, int requestCode)
\end{lstlisting}
where the string array is an array of permission strings.  All permissions that can be declared in \it{AndroidManifest.xml} can be accessed through \it{Manifest.permission.***}.  For example:
\begin{lstlisting}
private static final String[] LOCATION_PERMISSIONS = new String[] {
		Manifest.permission.ACCESS_FINE_LOCATION,
		Manifest.permission.ACCESS_COARSE_LOCATION
};
\end{lstlisting}
This method call has a callback to the method:
\begin{lstlisting}
public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions,
@NonNull int[] grantResults)
\end{lstlisting} 
which can be overridden
\begin{lstlisting}
@Override
public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {
	switch (requestCode) {
		case REQUEST_LOCATION_PERMISSIONS:
		if (hasLocationPermission()) {
			findImage();
		}
		default:
		super.onRequestPermissionsResult(requestCode, permissions, grantResults);
	}
}
\end{lstlisting}
You should check the request code, and if it matches, check that you have location permission (shorter than checking the response).

\subsection{Requesting Location}
\begin{lstlisting}
private void findImage() throws SecurityException {
	LocationRequest request = LocationRequest.create();
	request.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
	request.setNumUpdates(1);
	request.setInterval(0);
	LocationServices.FusedLocationApi.requestLocationUpdates(client, request, new LocationListener() {
		@Override
		public void onLocationChanged(Location location) {
			Log.i(TAG, "onLocationChanged: Got a fix: " + location);
		}
	});
}
\end{lstlisting}
// NOTE: \it{LocationServices.FusedLocationApi} is deprecated.

%%%%%%%%%%%%%%%%%%% Material Design %%%%%%%%%%%%%%%%%%%%%
\section{Material Design}


%%%%%%%%%%%%%%%%%%% StrictMode %%%%%%%%%%%%%%%%%%%%%
\section{StrictMode}
To activate \it{StrictMode}'s recommended policies, call:
\begin{lstlisting}
StrictMode.enableDefaults();
\end{lstlisting}
These include:
\begin{itemize}
	\item networking on the main thread.
	\item disk reads and writes on the main thread
	\item activities kept alive beyond their natural life-cycle 
	\subitem Also known as an \it{activity leak}
	\item un-closed SQLite database cursors
	\item clear-text network traffic not wrapped in SSL/TLS
\end{itemize}

%%%%%%%%%%%%%%%%%%% Unit Testing %%%%%%%%%%%%%%%%%%%%%
\section{Unit Testing}
\subsection{Creating a Test Class}
\begin{enumerate}
	\item Go to the class you want to test.
	\item 'command + shift + T' to navigate to the test class
	\item if there is no test class, select 'Create New Test...'
	\item Select 'JUnit4'
	\item set 'setUp/@Before' checked
	\item Keep everything else unchecked.
	\item Press OK.
	\item Choose between 'androidTest' and 'test'
\end{enumerate}
\subsubsection{\textit{androidTest} vs \textit{test}}
\paragraph{andoridTests} are run at run-time on a device or emulator withing the android environment.
\paragraph{tests} are run the the development machine outside of the android environment.
\\\\
\textit{test}s tend to be faster

\subsection{Setting Up the Test}

\subsubsection{Using Mocked Dependencies}

\subsection{Writing Tests}

%%%%%%%%%%%%%% Refactoring Techniques and Tools %%%%%%%%%%%%%%%%
\section{Refactoring Techniques and Tools}
There are many techniques and tools that can be used to make refactoring code easier.
\subsection{Extracting a method with Android Studio}
\begin{enumerate}
	\item  Highlight the code that you want to be extracted
	\item Right-click and select Refactor $\rightarrow$ Extract $\rightarrow$ Method
	\item Set the Visibility and method Name 
	\item Press Refactor or Preview to preview the changes
	\item If there are multiple occurrences of the highlighted text being extracted, android studio will ask if you want to replace these as well 
	\subitem You can either replace each occurrence one by one, or by choosing all.
\end{enumerate}

%%%%%%%%%%%%%% Building the APK %%%%%%%%%%%%%%%%
\section{Building the APK}
\subsection{Separate APK for Screen size}
Since all the files in the Drawable directory is built into the final APK, it can provide ALOT of bloat to the final app size.\\
Therefore, we can generate separate APKs for each screen denisity, containing only the necessary resources.  
\\
See configure-apk-splits
\subsubsection{Exception}
The only exception to this, every density of the launcher icon is maintained.

\end{document}
